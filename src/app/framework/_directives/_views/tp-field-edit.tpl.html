<div class="tp-field">
  <span>
    <md-input-container md-no-float>
      <span ng-if="isSingle && isSelfField">
        <span ng-switch="field.field_type">
          <md-datepicker ng-model="field._value.key" md-placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory" ng-switch-when="date_time">
          </md-datepicker>
          <div class="tp-switch" ng-switch-when="boolean">
            <md-switch class="md-primary" ng-model="field._value.key" aria-label="{{field.field_description}}">
              <span>{{ field._value.key && 'Yes' || 'No' }}</span>
            </md-switch>
          </div>
          <textarea ng-model="field._value.key" rows="2" md-select-on-focus aria-label="field.display_name" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory" placeholder="{{field.field_description}}" ng-switch-when="longstring"/>
          <input type="password" ng-model="field._value.key" aria-label="field.display_name" placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory" ng-switch-when="password">
          <input ng-model="field._value.key" aria-label="field.display_name" placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory" ng-switch-when="htmlLink">
          <text-angular ng-model="field._value.key" style="z-index:1" name="{{field.display_name}}_{{field.field_type}}" data-ng-required="field.mandatory" ng-switch-when="richstring"></text-angular>
          <tp:s3-explorer name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory" ng-switch-when="s3explorer"/>
          <tp:file field="field" mode="edit" ng-switch-when="file"/>
          <span class="header" ng-switch-when="divider">
            <div layout="row" layout-align="end center">
              <h3 flex>
                <a class="plain" md-colors="{color: 'primary-700'}">
                  {{field.display_name}}
                </a>
              </h3>
            </div>
            <md-divider></md-divider>
          </span>
          <tp:colour-palette name="{{field.display_name}}_{{field.field_type}}" mode="edit" ng-model="field._value.key" ng-required="field.mandatory" ng-switch-when="colour" />
          <div ng-switch-default>
            <div ng-if="!field.allowed_values">
              <input ng-model="field._value.key" aria-label="field.display_name" placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}"  ng-pattern="field.decvalidations">
            </div>
            <div ng-if="field.allowed_values">
              <md-select ng-model="field._value.key" placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory">
                <md-select-header class="search">
                  <md-input-container md-no-float>
                    <input ng-model="allowed.value" type="search" placeholder="Add New" ng-keydown="$event.stopPropagation()" ng-keyup="$event.keyCode == 13 ? addValue() : null" tp:auto-focus>
                  </md-input-container>
                </md-select-header>
                <md-option value="" ng-if="!field.mandatory">-- Clear --</md-option>
                <md-option ng-value="option" ng-repeat="option in field.allowed_values">{{ option }}</md-option>
              </md-select>
            </div>
          </div>
        </span>
      </span>
      <span ng-if="isArray && isSelfField" flex layout="column">
        <span ng-switch="field.field_type">
          <span ng-switch-when="file">
            <tp:file field="field" mode="edit"/>
          </span>
          <div ng-if="field.allowed_values">
            <md-select ng-model="field._value.key" multiple="true" placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory">
              <md-select-header class="search">
                <md-input-container md-no-float>
                  <input ng-model="allowed.value" type="search" placeholder="Add New" ng-keydown="$event.stopPropagation()" ng-keyup="$event.keyCode == 13 ? addValue() : null" tp:auto-focus>
                </md-input-container>
              </md-select-header>
              <md-option ng-value="option" ng-repeat="option in field.allowed_values">{{ option }}</md-option>
            </md-select>
          </div>
          <md-chips ng-if="!field.allowed_values" ng-model="field._value" md-transform-chip="wrapSimpleValue($chip)" class="tp-chips" placeholder="{{field.field_description}}" name="{{field.display_name}}_{{field.field_type}}" ng-required="field.mandatory" ng-switch-default>
            <md-chip-template>
              <span>{{$chip.key}}</span>
            </md-chip-template>
          </md-chips>
        </span>
      </span>
      <span ng-if="isTipoRef">
       <tp:lookup root="root" context="context" parent="parent" field="field" />
      </span>
      <div ng-messages="tipoForm[field.display_name + '_' +field.field_type].$error" multiple md-auto-hide="false">
          <div ng-message="required" >This is required.</div>
          <div ng-message="pattern" >This field must be {{field.validations_refs['ref' + field.validations]}}</div>
      </div>
    </md-input-container>
  </span>
</div>